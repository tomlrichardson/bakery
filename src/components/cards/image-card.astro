---
import type { ImageMetadata } from 'astro';
import { Image } from 'astro:assets';

interface Props {
  heading: string;
  text: string;
  image: {
    src: string;
    alt: string;
  };
  link: string;
  backgroundImage: string;
  backgroundColor: string;
}

const block = Astro.props;
// const images = import.meta.glob<{ default: ImageMetadata }>(
//   '/src/assets/*.{jpeg,jpg,png,gif,webp,avif,svg}',
//   { eager: true }
// );

// const imageSrc = images[block.image.src]?.default;
// const src =
//   typeof imageSrc === 'string'
//     ? imageSrc.replace(/^\./, '/_cloudcannon')
//     : imageSrc ?? block.image.src;

// if (!src) {
//   throw new Error(
//     `"${block.image.src}" does not exist in glob: "src/assets/*.{jpeg,jpg,png,gif}"`
//   );
// }
---

<a
  class="card"
  href={block.link}
  style={block.backgroundImage
    ? `background-image: url(${block.backgroundImage});`
    : `background-color: ${block.backgroundColor}`}>
  <div class="image">
    <Image
      class="hero__bg-img"
      alt={block.image.alt}
      src={block.image.src}
      width={2000}
      height={400}
    />
  </div>
  <h2>{block.heading}</h2>
  <p>{block.text}</p>
</a>
